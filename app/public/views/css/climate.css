 :root{
      --bg:#f7f9fc; --card:#ffffff; --fg:#0f172a; --muted:#64748b; --border:#e2e8f0;
      --primary:#2563eb; --primary-600:#1d4ed8; --accent:#0ea5e9; --shadow:0 12px 24px rgba(15,23,42,0.08);
      --success:#10b981; --warning:#f59e0b; --danger:#ef4444;
    }
    [data-theme="dark"]{
      --bg:#0b1020; --card:#0f172a; --fg:#e5e7eb; --muted:#94a3b8; --border:#1f2937;
      --primary:#3b82f6; --primary-600:#2563eb; --accent:#22d3ee; --shadow:0 12px 24px rgba(0,0,0,0.45);
    }
    *{ box-sizing:border-box }
    html, body { height: 100%; }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; direction: ltr; background: var(--bg); color: var(--fg); margin:0; }
    a { color: var(--primary); text-decoration: none; }
    /* Hide scrollbars globally but keep scrolling enabled */
    * { -ms-overflow-style: none; scrollbar-width: none; }
    *::-webkit-scrollbar { width: 0; height: 0; background: transparent; }
    *::-webkit-scrollbar-thumb { background: transparent; }
    *::-webkit-scrollbar-track { background: transparent; }
    /* Top bar */
    .topbar { position:sticky; top:0; z-index: 100; height:60px; background:linear-gradient(90deg, rgba(255,255,255,0.85), rgba(255,255,255,0.7)); backdrop-filter:saturate(180%) blur(10px); border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; gap:10px; padding:0 16px; box-shadow: 0 6px 20px rgba(15,23,42,0.08); }
    [data-theme="dark"] .topbar { background:linear-gradient(90deg, rgba(15,23,42,0.8), rgba(15,23,42,0.6)); }
    .brand { font-weight:900; letter-spacing:0.2px; font-size:16px; }
    .toolbar { display:flex; align-items:center; gap:8px; }
  .btn { position:relative; overflow:hidden; background: var(--primary); color:#fff; border:none; border-radius:12px; padding:10px 12px; font-weight:800; cursor:pointer; transition: transform .08s ease, box-shadow .18s ease, background .18s ease; box-shadow: 0 6px 14px rgba(37,99,235,0.18); }
    .btn:hover { background:var(--primary-600); box-shadow: 0 8px 18px rgba(37,99,235,0.24); transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }
    .btn.secondary { background: transparent; color: var(--fg); border:1px solid var(--border); box-shadow:none; }
    .btn.secondary:hover { background: rgba(37,99,235,0.06); }
    .btn.warn { background: var(--warning); }
  .btn .icon { display:inline-flex; width:16px; height:16px; margin-inline-start:6px; opacity:.9; }
  .btn.loading { opacity:.7; pointer-events:none; }
  .ripple { position:absolute; border-radius:50%; transform:scale(0); animation:ripple .5s ease-out; background:rgba(255,255,255,0.5); pointer-events:none; }
  @keyframes ripple { to { transform:scale(12); opacity:0; } }
  .container { max-width:1500px; margin: 16px auto; padding: 0 16px 24px; }
    .cards { display:grid; grid-template-columns: 1fr; gap:16px; }
    @media (min-width: 1000px){ .cards { grid-template-columns: 1.1fr 0.9fr; } }
    .card { background: var(--card); border:1px solid var(--border); border-radius:16px; box-shadow: var(--shadow); overflow:hidden; }
    .card .card-header { padding:14px 16px; font-weight:900; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
    .card .card-body { padding:16px; }
  .kpis { display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-bottom:12px; }
  .kpi { background: linear-gradient(180deg, rgba(37,99,235,0.06), rgba(37,99,235,0.02)); border:1px solid var(--border); border-radius:12px; padding:10px 12px; box-shadow: 0 8px 20px rgba(37,99,235,0.06); transition: transform .12s ease, box-shadow .18s ease; }
  .kpi:hover { transform: translateY(-1px); box-shadow: 0 10px 22px rgba(37,99,235,0.10); }
  .kpi .label { font-size:12px; color: var(--muted); }
  .kpi .value { font-size:20px; font-weight:900; margin-top:4px; }
  .progress { height: 8px; background: rgba(37,99,235,0.12); border-radius:999px; overflow:hidden; border:1px solid var(--border); }
  .progress > div { height:100%; width:0%; background: linear-gradient(90deg, var(--primary), var(--accent)); transition: width .2s ease; }
    .row { display:flex; gap:8px; align-items:center; }
    .half { flex: 1; }
    .input, .select { -webkit-appearance:none; appearance:none; width:100%; background: var(--card); color: var(--fg); border:1px solid var(--border); border-radius: 12px; padding: 10px 12px; outline:none; transition: border-color .15s ease, box-shadow .15s ease, background .15s ease; box-shadow: inset 0 1px 2px rgba(0,0,0,0.035); }
    .input::placeholder { color: var(--muted); opacity: .8; }
    .input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37,99,235,0.22); }
    .help { color: var(--muted); font-size: 12px; margin-top:4px; }
    .inline-help { color: var(--muted); font-size: 12px; margin: 4px 0 -6px; text-align:center; }
    .muted { color: var(--muted); }
  /* Chips and controls */
  .chips { display:flex; gap:8px; overflow:auto; padding:6px 2px 2px; }
  .chip { flex:0 0 auto; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:var(--card); color:var(--fg); cursor:pointer; font-weight:700; box-shadow: inset 0 1px 2px rgba(0,0,0,0.03); }
  .chip:hover { background: rgba(37,99,235,0.06); }
  .slider-row { display:flex; align-items:center; gap:10px; margin-top:10px; }
  input[type="range"].slider { width:100%; accent-color: var(--primary); }
  .icon-btn { background:transparent; border:1px solid var(--border); color:var(--fg); border-radius:12px; padding:8px 10px; cursor:pointer; display:inline-flex; align-items:center; gap:6px; }
  .icon-btn:hover { background: rgba(37,99,235,0.06); }
  .icon-16 { width:16px; height:16px; display:inline-block; }
    /* Table */
    table { width:100%; border-collapse: collapse; background: var(--card); border:1px solid var(--border); border-radius:12px; overflow:hidden; }
    th, td { border-bottom: 1px solid var(--border); padding: 10px; text-align:center; }
    th { background: rgba(37,99,235,0.08); color: var(--fg); }
    tr:last-child td { border-bottom:none; }
    /* Chart */
    #chartContainer { width: 100%; margin: 0; }
  /* Give the chart a predictable height for better readability */
  #climateChart { width: 100%; height: 340px !important; }
  /* Skeletons */
  .skeleton { position:relative; overflow:hidden; background: linear-gradient(90deg, rgba(148,163,184,0.12), rgba(148,163,184,0.2), rgba(148,163,184,0.12)); background-size:200% 100%; animation: shimmer 1.2s infinite; border:1px solid var(--border); border-radius:12px; }
  .skeleton-card { height: 260px; margin: 10px 0; }
  .skeleton-table { height: 180px; margin-top:12px; }
  @keyframes shimmer { 0%{ background-position:200% 0 } 100%{ background-position:-200% 0 } }
  /* AI box */
  .ai-box { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:12px; margin-top:16px; box-shadow: var(--shadow); }
  .ai-row { display:flex; gap:8px; align-items:center; flex-wrap:wrap }
  .ai-row input { width:320px; max-width:90%; }
  #aiOutput { background:linear-gradient(180deg,rgba(37,99,235,0.04),rgba(37,99,235,0.02)); border:1px solid var(--border); border-radius:12px; padding:12px; margin-top:12px; max-height:max-content; overflow:auto }
  #aiOutput .ai-header { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px; }
  #aiOutput .ai-title { font-weight:900; font-size:14px; }
  #aiOutput .ai-tools { display:flex; gap:6px; }
  #aiOutput .ai-tinybtn { border:1px solid var(--border); background:var(--card); color:var(--fg); border-radius:8px; padding:6px 8px; cursor:pointer; font-weight:700; font-size:12px; }
  #aiOutput .ai-tinybtn:hover { background: rgba(37,99,235,0.06); }
  #aiOutput .ai-grid { display:grid; grid-template-columns: 1fr; gap:10px; }
  #aiOutput .ai-card { border:1px solid var(--border); background:var(--card); border-radius:12px; padding:10px; box-shadow: 0 10px 22px rgba(37,99,235,0.06); position:relative; overflow:hidden; }
  #aiOutput .ai-card::before { content:''; position:absolute; inset:0 0 auto 0; height:4px; background:linear-gradient(90deg, var(--primary), var(--accent)); opacity:.8; }
  #aiOutput .ai-badge { display:inline-flex; align-items:center; gap:6px; padding:2px 8px; border-radius:999px; font-weight:800; font-size:12px; border:1px solid var(--border); background: rgba(37,99,235,0.08); }
  #aiOutput .ai-card h4 { margin:8px 0 4px; font-size:15px; }
  #aiOutput .ai-desc { color: var(--muted); font-size:13px; line-height:1.7; }
  #aiOutput .ai-solution { margin-top:8px; display:flex; align-items:flex-start; gap:8px; background: linear-gradient(180deg, rgba(16,185,129,0.12), rgba(16,185,129,0.05)); border:1px solid rgba(16,185,129,0.35); color:#ffffff; border-radius:10px; padding:8px 10px; }
  #aiOutput .ai-solution .label { font-weight:900; font-size:12px; background:#a7f3d0; color:#065f46; border:1px solid #10b981; border-radius:999px; padding:2px 8px; }
  #aiOutput .ai-forecast { margin-top:10px; display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px; }
  #aiOutput .ai-forecast .f-card { border:1px solid var(--border); background:var(--card); border-radius:10px; padding:8px; text-align:center; }
  #aiOutput .ai-forecast .f-title { font-weight:800; font-size:12px; color: var(--muted); }
  #aiOutput .ai-forecast .f-value { margin-top:4px; font-weight:900; font-size:16px; }
  #aiOutput .trend-up { color:#065f46; background:#d1fae5; border:1px solid #10b981; }
  #aiOutput .trend-down { color:#7c2d12; background:#ffedd5; border:1px solid #fb923c; }
  #aiOutput .trend-flat { color:#1f2937; background:#e5e7eb; border:1px solid #cbd5e1; }
  #aiOutput .ai-raw { white-space:pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12px; border:1px dashed var(--border); padding:10px; border-radius:10px; background:linear-gradient(180deg,rgba(0,0,0,0.02),rgba(0,0,0,0.04)); }
  /* AI skeleton */
  #aiOutput .ai-skeleton { display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:10px; }
  #aiOutput .ai-skeleton .sk { height:92px; border-radius:12px; background: linear-gradient(90deg, rgba(148,163,184,0.12), rgba(148,163,184,0.2), rgba(148,163,184,0.12)); background-size:200% 100%; animation: shimmer 1.1s infinite; border:1px solid var(--border); }
    /* Footer */
    .footer { text-align:center; color: var(--muted); padding: 12px; }
    /* Toasts */
    #toasts { position: fixed; bottom: 14px; left: 50%; transform: translateX(-50%); display:flex; flex-direction:column; gap:8px; z-index:9999; }
    .toast { background: var(--card); border:1px solid var(--border); box-shadow: var(--shadow); color: var(--fg); padding:10px 12px; border-radius:12px; min-width: 220px; text-align:center; font-weight:700; }
    .toast.success { border-color: #10b981; }
    .toast.warn { border-color: #f59e0b; }
    .toast.error { border-color: #ef4444; }
    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){ *{ transition-duration: 0.001ms !important; animation-duration:.001ms !important; } }